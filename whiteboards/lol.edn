{:blocks
 ({:block/content "adsdasd",
   :block/format :markdown,
   :block/left
   {:block/name "lol",
    :block/uuid #uuid "62f399b1-39f3-4d46-874b-299a4cc79e74"},
   :block/parent
   {:block/name "lol",
    :block/uuid #uuid "62f399b1-39f3-4d46-874b-299a4cc79e74"},
   :block/uuid #uuid "62f3de0c-6c6f-4390-bc4f-252aab4adc84"}
  {:block/content "dsdaf",
   :block/format :markdown,
   :block/left
   {:block/uuid #uuid "62f3de0c-6c6f-4390-bc4f-252aab4adc84"},
   :block/parent
   {:block/name "lol",
    :block/uuid #uuid "62f399b1-39f3-4d46-874b-299a4cc79e74"},
   :block/uuid #uuid "62f3de89-a018-4964-b25b-297b543bb850"}
  {:block/content "",
   :block/format :markdown,
   :block/left
   {:block/uuid #uuid "62f3de89-a018-4964-b25b-297b543bb850"},
   :block/parent
   {:block/name "lol",
    :block/uuid #uuid "62f399b1-39f3-4d46-874b-299a4cc79e74"},
   :block/uuid #uuid "62f3de8d-1b4d-4555-a55b-f01b6cdbf474"}
  {:block/content "f",
   :block/format :markdown,
   :block/left
   {:block/uuid #uuid "62f3de8d-1b4d-4555-a55b-f01b6cdbf474"},
   :block/parent
   {:block/name "lol",
    :block/uuid #uuid "62f399b1-39f3-4d46-874b-299a4cc79e74"},
   :block/uuid #uuid "62f3e5a4-637f-4fd8-a572-b4c4c2ec7cad"}
  {:block/content "d",
   :block/format :markdown,
   :block/left
   {:block/uuid #uuid "62f3e5a4-637f-4fd8-a572-b4c4c2ec7cad"},
   :block/parent
   {:block/name "lol",
    :block/uuid #uuid "62f399b1-39f3-4d46-874b-299a4cc79e74"},
   :block/uuid #uuid "6302fda2-4b81-4262-b35d-0affa1f9665a"}
  {:block/content
   "Hua Lu\n  13:11\nhttps://jira.freewheel.tv/browse/ESC-47757 有个spark-ui 3.x的time-picker的问题，跟next版本的问题一样，popup append到body了\n\n\n\n\n\n13:12\nbiz-ui那边自己发现的\n\n\n\n\n\n\n\nchunyingwang\n  13:12\n非bff的不会有问题吧 ？\n\n\n\n\n\n\n\nHua Lu\n  13:12\n不会\n\n\n\n\n\n13:13\n就是有shadow-dom才会有的问题吧",
   :block/format :markdown,
   :block/left
   {:block/uuid #uuid "6302fda2-4b81-4262-b35d-0affa1f9665a"},
   :block/parent
   {:block/name "lol",
    :block/uuid #uuid "62f399b1-39f3-4d46-874b-299a4cc79e74"},
   :block/uuid #uuid "630319ad-1722-440c-b61d-a30e16e47dc1"}
  {:block/properties
   {:rotation 0,
    :index 0,
    :scale [1 1],
    :ls-type :whiteboard-shape,
    :type "html",
    :size [668.8737182617188 800],
    :id "abe4d370-21de-11ed-805f-5121e445752b",
    :point [-56.042315581571415 345.91867574679253],
    :parentId "62f399b1-39f3-4d46-874b-299a4cc79e74",
    :nonce 1661147790102,
    :html
    "<meta charset=\"utf-8\"><header class=\"kWUGWQ diLtXU iATxZH cTVtxN\" style=\"transition: background-color 0.1s ease-in-out 0s; display: block; padding: 22.5px 22.5px 0px; color: rgb(55, 71, 91); font-family: &quot;Source Sans Pro&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;\"><h1 class=\"kiMAEz buowod rXoKk dIAaBe hyjQvk ctpWtp\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0px 0px 15px; padding: 0px; word-break: break-word; font-size: 1.40625rem; color: var(--title); line-height: 1.125; font-weight: 400;\">为什么你不应该在 React 中直接使用 useEffect 从 API 获取数据</h1><div class=\"epEjwu\" style=\"transition: background-color 0.1s ease-in-out 0s; color: var(--t-l);\"><time datetime=\"2022-08-19T08:53:00.000Z\" style=\"transition: background-color 0.1s ease-in-out 0s;\">2022-08-19</time><span class=\"jTjNVR hIrAsl hNjeNG dDVQEX gKQCBv\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin: 0px 7.5px;\"></span><a class=\"epEjwu\" href=\"https://blog.skk.moe/categories/%E6%8A%80%E6%9C%AF%E5%90%91/\" style=\"transition: background-color 0.1s ease-in-out 0s; color: var(--t-l); text-decoration: none; cursor: pointer;\">技术向</a><span class=\"jTjNVR hIrAsl hNjeNG dDVQEX gKQCBv\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin: 0px 7.5px;\"></span>约 8.8 千字</div></header><section class=\"hWolbT ifowTF diLtXU iATxZH cTVtxN hyjQvk kKplrA dwPPpV bZHNaj cZVeuK\" id=\"p_post__DqeBx\" style=\"transition: background-color 0.1s ease-in-out 0s; display: block; overflow-wrap: break-word; contain: content; font-size: 1rem; margin-bottom: 15px; padding: 15px 22.5px 0px; --prism-comment:#a0ada0; --prism-string:#b56959; --prism-number:#296aa3; --prism-keyword:#1c6b48; --prism-function:#6c7834; --prism-boolean:#1c6b48; --prism-constant:#a65e2b; --prism-deleted:#a14f55; --prism-class:#2993a3; --prism-builtin:#ab5959; --prism-property:#b58451; --prism-namespace:#b05a78; --prism-punctuation:#8e8f8b; --prism-decorator:#bd8f8f; --prism-regex:#ab5e3f; --prism-json-property:#698c96; --pre:#f4f5f7; --kbd:#fafbfc; --link-line:rgba(84,145,231,0.5); --link-line-hover:var(--link); font-weight: 400; line-height: 1.5; hyphens: auto; color: rgb(55, 71, 91); font-family: &quot;Source Sans Pro&quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;\"><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0px 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">React 是一个由 Facebook 开源的、可以在任意平台上构建 UI 的 JavaScript 库。在 React 中，一个常见的 Pattern 是使用<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px;\">useEffect</code><span>&nbsp;</span>搭配<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-bottom: 0px;\">useState</code><span>&nbsp;</span>发送请求、将状态从 API（React 外部）同步到 React 内部、用于渲染 UI，这篇文章恰恰在向你介绍为什么你不应该直接这么做。</p><h2 id=\"TL-DR-6\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px 0.75rem; padding: 0px; scroll-margin-top: 0.75rem; font-weight: 600; color: var(--title); font-size: 24px; line-height: 32px; letter-spacing: 0.02em;\">TL; DR</h2><ul style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0px; padding: 0px 0px 0px 1.5rem; list-style: outside disc;\"><li style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0px 0px 0.375rem; padding: 0px; list-style-type: unset;\">绝大部分触发网络请求的原因都是用户操作，应该在 Event Handler 中发送网络请求</li><li style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.375rem 0px; padding: 0px; list-style-type: unset;\">大部分时候，首屏需要的数据可以通过服务端渲染 SSR 直出、无需在客户端额外发送网络请求</li><li style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.375rem 0px; padding: 0px; list-style-type: unset;\">即使需要客户端在首屏获取数据，未来 React 和社区维护的库会提供基于 Suspense 的数据请求 Pattern、实现「Render as your fetch」</li><li style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.375rem 0px 0px; padding: 0px; list-style-type: unset;\">即使在使用「Fetch on render」的 Pattern，也应该直接使用第三方库如 SWR 或 React Query，而不是直接使用<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px; margin-bottom: 0px;\">useEffect</code></li></ul><h2 id=\"Cong-Fa-Song-Yi-Ge-Jian-Dan-De-Qing-Qiu-Kai-Shi\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px 0.75rem; padding: 0px; scroll-margin-top: 0.75rem; font-weight: 600; color: var(--title); font-size: 24px; line-height: 32px; letter-spacing: 0.02em;\">从发送一个简单的请求开始</h2><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">设想一下你在编写一个 React 应用，需要从 API 获取产品列表数据、并渲染到页面上。你想到了网络请求不属于渲染、而是渲染的副作用，你还想到了 React 提供了一个专门的 Hook<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px;\">useEffect</code><span>&nbsp;</span>用于处理渲染的副作用，最常见的场景就是将属于 React 外部的状态同步到 React 内部中。你不假思索，实现了一个<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-bottom: 0px;\">&lt;ProductList /&gt;</code><span>&nbsp;</span>组件：</p><pre class=\"language-jsx hljs\" data-lang=\"JSX\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content; position: relative;\"><code class=\"language-jsx\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\"><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">ProductList</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>products<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setProducts<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useEffect</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">fetch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'https://dummyjson.com/products'</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">res</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> res<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">json</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">data</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setProducts</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>\n    <span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; margin-bottom: 0px; color: var(--prism-punctuation);\">&lt;</span>ul</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n      </span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>products<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">map</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">product</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>\n        <span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Product</span></span> <span class=\"token spread\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">{</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">...</span>product<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span> <span class=\"token attr-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-property);\">key</span><span class=\"token script language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token script-punctuation punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">=</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>product<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>id<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">/&gt;</span></span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n    </span><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; margin-bottom: 0px; color: var(--prism-punctuation);\">&lt;/</span>ul</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></code></pre><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">你运行<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px; margin-bottom: 0px;\">npm run dev</code>，成就感满满地看见产品列表显示在页面上。</p><h2 id=\"Zai-UI-Zhong-Zhan-Shi-Jia-Zai-Zhong-He-Cuo-Wu\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px 0.75rem; padding: 0px; scroll-margin-top: 0.75rem; font-weight: 600; color: var(--title); font-size: 24px; line-height: 32px; letter-spacing: 0.02em;\">在 UI 中展示「加载中」和错误</h2><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">你发现首次加载的时候，直到数据加载完成之前页面都是白屏，用户体验很不好。于是你决定实现一个「加载中」的进度条、引入了一个新的状态<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px; margin-bottom: 0px;\">isLoading</code>：</p><pre class=\"language-jsx hljs\" data-lang=\"JSX\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content; position: relative;\"><code class=\"language-jsx\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\"><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">ProductList</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setIsLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>products<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setProducts<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useEffect</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">fetch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'https://dummyjson.com/products'</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">res</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> res<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">json</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">data</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n        <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setProducts</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n        <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span><span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">/* TODO 实现一个骨架屏 &lt;Skeleton /&gt; 改善 UX、避免 CLS */</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Loading</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">正在玩命加载中...</span><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;/</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Loading</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>\n    <span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; margin-bottom: 0px; color: var(--prism-punctuation);\">&lt;</span>ul</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n      </span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>products<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">map</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">product</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>\n        <span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Product</span></span> <span class=\"token spread\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">{</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">...</span>product<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span> <span class=\"token attr-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-property);\">key</span><span class=\"token script language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token script-punctuation punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">=</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>product<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>id<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">/&gt;</span></span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n    </span><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; margin-bottom: 0px; color: var(--prism-punctuation);\">&lt;/</span>ul</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></code></pre><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">然后你又意识到，除了一个「正在玩命加载中」以外，你还需要在服务器出错时显示错误提示、必要时还要上报错误日志，于是你又引入了一个新的状态<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px; margin-bottom: 0px;\">error</code>：</p><pre class=\"language-jsx hljs\" data-lang=\"JSX\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content; position: relative;\"><code class=\"language-jsx\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\"><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">ProductList</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setIsLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>products<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setProducts<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>error<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setError<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useEffect</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">fetch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'https://dummyjson.com/products'</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">res</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> res<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">json</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">data</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n        <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setProducts</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n        <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">catch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">err</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n        <span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">// TODO 错误日志上报</span>\n        <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setError</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>err<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span><span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">/* TODO 实现一个骨架屏 &lt;Skeleton /&gt; 改善 UX、避免 CLS */</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Loading</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">正在玩命加载中...</span><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;/</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Loading</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>error<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span><span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">/* TODO 添加「重试」按钮 */</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; margin-bottom: 0px; color: var(--prism-punctuation);\">&lt;</span>div</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">出现错误啦！</span><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; margin-bottom: 0px; color: var(--prism-punctuation);\">&lt;/</span>div</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>\n    <span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; margin-bottom: 0px; color: var(--prism-punctuation);\">&lt;</span>ul</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n      </span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>products<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">map</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">product</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>\n        <span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Product</span></span> <span class=\"token spread\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">{</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">...</span>product<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span> <span class=\"token attr-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-property);\">key</span><span class=\"token script language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token script-punctuation punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">=</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>product<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>id<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">/&gt;</span></span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n    </span><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; margin-bottom: 0px; color: var(--prism-punctuation);\">&lt;/</span>ul</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></code></pre><h2 id=\"Feng-Zhuang-Yi-Ge-Xin-De-Hook\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px 0.75rem; padding: 0px; scroll-margin-top: 0.75rem; font-weight: 600; color: var(--title); font-size: 24px; line-height: 32px; letter-spacing: 0.02em;\">封装一个新的 Hook</h2><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">你发现每个需要从 API 获取数据的组件都需要重复上述的代码，非常繁琐。于是你决定将其封装成一个<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px; margin-bottom: 0px;\">useFetch</code><span>&nbsp;</span>的 Hook，在组件中可以直接调用：</p><pre class=\"language-javascript hljs\" data-lang=\"JAVASCRIPT\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content; position: relative;\"><code class=\"language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\"><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useFetch</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">,</span> requestInit <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setIsLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setData<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>error<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setError<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useEffect</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">fetch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> requestInit<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">res</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> res<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">json</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">data</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n        <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setData</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n        <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">catch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">err</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setError</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>err<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> requestInit<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span> data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> error <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></code></pre><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">现在，你可以直接在组件中使用<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px; margin-bottom: 0px;\">useFetch</code><span>&nbsp;</span>Hook 了：</p><pre class=\"language-jsx hljs\" data-lang=\"JSX\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content; position: relative;\"><code class=\"language-jsx\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\"><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">ProductList</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span> isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> error <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useFetch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'https://dummyjson.com/products'</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n\n<span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">Product</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">{</span> id <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span> isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> error <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useFetch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token template-string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token template-punctuation string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-string);\">`</span><span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">https://dummyjson.com/products/</span><span class=\"token interpolation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-interpolation);\"><span class=\"token interpolation-punctuation punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">${</span>id<span class=\"token interpolation-punctuation punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span><span class=\"token template-punctuation string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-string);\">`</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></code></pre><h2 id=\"Chu-Li-Race-Condition\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px 0.75rem; padding: 0px; scroll-margin-top: 0.75rem; font-weight: 600; color: var(--title); font-size: 24px; line-height: 32px; letter-spacing: 0.02em;\">处理 Race Condition</h2><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">你实现了一个在多个产品之间切换的轮播组件，当前展示的产品存储在状态<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px; margin-bottom: 0px;\">curentProduct</code><span>&nbsp;</span>中：</p><pre class=\"language-jsx hljs\" data-lang=\"JSX\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content; position: relative;\"><code class=\"language-jsx\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\"><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">Carousel</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">{</span> intialProductId <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>currentProduct<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setCurrentProduct<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>intialProductId<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span> data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> error <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useFetch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token template-string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token template-punctuation string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-string);\">`</span><span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">https://dummyjson.com/products/</span><span class=\"token interpolation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-interpolation);\"><span class=\"token interpolation-punctuation punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">${</span>currentProduct<span class=\"token interpolation-punctuation punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span><span class=\"token template-punctuation string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-string);\">`</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">;</span></code></pre><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">结果你在测试时发现，在轮播组件中快速切换时，有时候当你点击下一个产品，界面上却展示了上一个产品。<br style=\"transition: background-color 0.1s ease-in-out 0s; margin-top: 0px;\">因为你没有在<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-bottom: 0px;\">useEffect</code><span>&nbsp;</span>中声明如何清除你的副作用。发送网络请求是一个异步的行为，收到服务器数据的顺序并不一定是网络请求发送时的顺序、出现了 Race Condition：</p><pre class=\"language-none\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content;\"><code class=\"language-none\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\">| =============== Request Product 1 ===============&gt; | setState()\n      | ===== Request Product 2 ====&gt; | setState() |</code></pre><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">如果发生了如上所示的第二个产品的数据返回地比第一个产品快的情况，你的<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px; margin-bottom: 0px;\">data</code><span>&nbsp;</span>就会被第一个产品的数据覆盖掉。</p><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">于是你在<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px; margin-bottom: 0px;\">useFetch</code><span>&nbsp;</span>中写了一个清除副作用的逻辑：</p><pre class=\"language-javascript hljs\" data-lang=\"JAVASCRIPT\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content; position: relative;\"><code class=\"language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\"><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useFetch</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">,</span> requestInit <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setIsLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setData<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>error<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setError<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useEffect</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">let</span> isCancelled <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n    <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">fetch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> requestInit<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">res</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> res<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">json</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">data</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n        <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">!</span>isCancelled<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n          <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setData</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n          <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n        <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">catch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">err</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n        <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">!</span>isCancelled<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n          <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setError</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>err<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n          <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n        <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      isCancelled <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> requestInit<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span> data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> error <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></code></pre><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">感谢 JavaScript 闭包的力量，现在即使 Product 2 的数据比 Product 1 的数据更早返回，Product 1 的数据也不会覆盖掉 Product 2 的数据。</p><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">你还可以在清除副作用时检测当前浏览器是否支持<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px;\">AbortController</code>、用<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-bottom: 0px;\">AbortSignal</code><span>&nbsp;</span>取消中止网络请求：</p><pre class=\"language-javascript hljs\" data-lang=\"JAVASCRIPT\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content; position: relative;\"><code class=\"language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\"><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-keyword);\">const</span> isAbortControllerSupported <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">typeof</span> AbortController <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">!==</span> <span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'undefined'</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n<span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useFetch</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">,</span> requestInit <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setIsLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setData<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>error<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setError<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useEffect</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">let</span> isCancelled <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">let</span> abortController <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>isAbortControllerSupported<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      abortController <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">new</span> <span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-class);\">AbortController</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n\n    <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">fetch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span> <span class=\"token literal-property property\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-property);\">signal</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">:</span> abortController<span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">?.</span>signal<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">...</span>requestInit <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n      <span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">// .then(...</span>\n\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      isCancelled <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      abortController<span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">?.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">abort</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> requestInit<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span> data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> error <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></code></pre><h2 id=\"Huan-Cun-Wang-Luo-Qing-Qiu\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px 0.75rem; padding: 0px; scroll-margin-top: 0.75rem; font-weight: 600; color: var(--title); font-size: 24px; line-height: 32px; letter-spacing: 0.02em;\">缓存网络请求</h2><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">让我们继续回到上述的轮播组件。</p><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">每当轮播组件切换时，<code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px;\">&lt;Product /&gt;</code><span>&nbsp;</span>就会接受一个新的<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">props.id</code>、组件就会经历一次更新、<code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">url</code><span>&nbsp;</span>发生改变、<code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">useEffect</code><span>&nbsp;</span>重新执行、触发一次新的网络请求。为了去除后续不必要的网络请求，<code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-bottom: 0px;\">useFetch</code><span>&nbsp;</span>需要一个缓存：</p><pre class=\"language-javascript hljs\" data-lang=\"JAVASCRIPT\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content; position: relative;\"><code class=\"language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\"><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-keyword);\">const</span> isAbortControllerSupported <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">typeof</span> AbortController <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">!==</span> <span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'undefined'</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">/** TODO 将 RequestInit 对象也存在缓存里 */</span>\n<span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> cache <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">new</span> <span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-class);\">Map</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n<span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useFetch</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">,</span> requestInit <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setIsLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setData<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>error<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setError<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useEffect</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">let</span> isCancelled <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">let</span> abortController <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>isAbortControllerSupported<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      abortController <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">new</span> <span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-class);\">AbortController</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>cache<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">has</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setData</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>cache<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">get</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">else</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">fetch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span> <span class=\"token literal-property property\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-property);\">signal</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">:</span> abortController<span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">?.</span>signal<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">...</span>requestInit <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n        <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">res</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> res<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">json</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n        <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">data</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n          <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">!</span>isCancelled<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n            cache<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">set</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n            <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setData</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n            <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n          <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n        <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n        <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">catch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">err</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n          <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">!</span>isCancelled<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n            <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setError</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>err<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n            <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n          <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n        <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      isCancelled <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      abortController<span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">?.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">abort</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> requestInit<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span> data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> error <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></code></pre><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">你开始有点头疼了吗？不要着急，我们才刚刚开始。</p><h2 id=\"Huan-Cun-Shua-Xin\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px 0.75rem; padding: 0px; scroll-margin-top: 0.75rem; font-weight: 600; color: var(--title); font-size: 24px; line-height: 32px; letter-spacing: 0.02em;\">缓存刷新</h2><blockquote class=\"iOARSJ ycSPk gVjJHb jSrOVh bCTcdn bYMDIj hcoyLE hvUkwC\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; padding: 0.75rem 1rem; background-color: var(--c-bg); border-left-width: 0.25em; border-left-color: var(--border); border-left-style: solid;\"><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0px; font-family: &quot;Source Sans Pro&quot;;\">There are 2 hard problems in computer science: naming things, cache invalidation, and off-by-1 errors.</p></blockquote><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">有了缓存，你就需要刷新缓存，不然你的显示在 UI 上的数据就可能过时。你有很多的时机可以刷新缓存，比如你可以在标签页失去 Focus 的时候刷新缓存：</p><pre class=\"language-javascript hljs\" data-lang=\"JAVASCRIPT\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content; position: relative;\"><code class=\"language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\"><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-keyword);\">const</span> isAbortControllerSupported <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">typeof</span> AbortController <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">!==</span> <span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'undefined'</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> cache <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">new</span> <span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-class);\">Map</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> isSupportFocus <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">typeof</span> document <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">!==</span> <span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'undefined'</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">&amp;&amp;</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">typeof</span> document<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>hasFocus <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">===</span> <span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'function'</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n<span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useFetch</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">,</span> requestInit <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setIsLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setData<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>error<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> setError<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useState</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> removeCache <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useCallback</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    cache<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">delete</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> revalidate <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useCallback</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">// TODO 重新 fetch 获取数据填充缓存</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>， <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useEffect</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">onBlur</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">removeCache</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">onFocus</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">revalidate</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n    window<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">addEventListener</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'focus'</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> onFocus<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    window<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">addEventListener</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'blur'</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> onBlur<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      window<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">removeEventListener</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'focus'</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> onFocus<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      window<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">removeEventListener</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token string\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-string);\">'blur'</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> onBlur<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n\n  <span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">// fetch 相关逻辑</span>\n  <span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">// useEffect(() =&gt; ...</span>\n\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span> data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> isLoading<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> error <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></code></pre><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">你还可以定时重复更新缓存（interval），你还可以当用户网络状态发生改变时（从数据流量切换到 Wi-Fi 时）更新缓存。现在你需要写更多的<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px;\">useEffect</code><span>&nbsp;</span>和<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-bottom: 0px;\">addEventListener</code><span>&nbsp;</span>了。</p><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">而且，当组件卸载、重新挂载时，你虽然可以先使用缓存渲染界面避免再次白屏，但是你随后需要异步刷新缓存、最后将最新数据再更新到 UI 上。</p><h2 id=\"Jian-Rong-React-18-Concurrent-Rendering\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px 0.75rem; padding: 0px; scroll-margin-top: 0.75rem; font-weight: 600; color: var(--title); font-size: 24px; line-height: 32px; letter-spacing: 0.02em;\">兼容 React 18 Concurrent Rendering</h2><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">React 18 引入了 Concurrent Rendering 的概念。简单来说，当 opt-in 了 Concurrent Rendering 之后，React 能够打断、暂停、甚至中止被标记为「低优先级」的 Update（如 Transition）、为「高优先级」的 Update 让路。</p><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">在实现<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px;\">useFetch</code><span>&nbsp;</span>的缓存时，<code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">cache</code><span>&nbsp;</span>是一个全局变量，每一个组件中的每一个<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">useFetch</code><span>&nbsp;</span>都能够直接读写<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">cache</code>。虽然<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">cache.get</code><span>&nbsp;</span>时得到的数据都是最新的，但是一个<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">useFetch</code><span>&nbsp;</span>调用<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">cache.set</code><span>&nbsp;</span>后，<code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">cache</code><span>&nbsp;</span>却无法通知其他<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">useFetch</code><span>&nbsp;</span>需要更新、只能被动地等待其他<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">useFetch</code><span>&nbsp;</span>的下次<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-bottom: 0px;\">cache.get</code>。</p><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">假设你的<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px;\">&lt;ProductList /&gt;</code><span>&nbsp;</span>组件使用了 React 18 的 Concurrent API，如<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">useTransition</code><span>&nbsp;</span>或<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">startTransition</code>，同时<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">&lt;ProductList /&gt;</code><span>&nbsp;</span>和<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">&lt;Carousel /&gt;</code><span>&nbsp;</span>都使用了<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">useFetch('https://dummyjson.com/products')</code><span>&nbsp;</span>获取从同一个 API 获取数据。由于<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">&lt;ProductList&gt;</code><span>&nbsp;</span>组件 opt in 了 Concurrent Rendering，因此<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">&lt;ProductList /&gt;</code><span>&nbsp;</span>和<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">&lt;Carousel /&gt;</code><span>&nbsp;</span>渲染和更新不一定是同时发生的（React 可能会为了响应用户与<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">&lt;Carousel /&gt;</code><span>&nbsp;</span>的交互，暂停<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">&lt;ProductList /&gt;</code><span>&nbsp;</span>的更新，即两个组件的更新不是同步的），而在两次更新之间，<code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">useFetch</code><span>&nbsp;</span>的缓存可能由于刷新、发生了改变，最终导致<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">&lt;ProductList /&gt;</code><span>&nbsp;</span>和<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">&lt;Carousel /&gt;</code><span>&nbsp;</span>分别的<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-bottom: 0px;\">useFetch</code><span>&nbsp;</span>使用了不同的缓存数据，导致了不一致（Tearing）。</p><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">为了避免 Tearing、通知 React 全局变量的更新并安排重新渲染，你需要重新实现<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px;\">cache</code>、以使用 React 18 的另一个 Hook<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-bottom: 0px;\">useSyncExternalStore</code>：</p><pre class=\"language-javascript hljs\" data-lang=\"JAVASCRIPT\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content; position: relative;\"><code class=\"language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\"><span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-keyword);\">const</span> cache <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token literal-property property\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-property);\">__internalStore</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">:</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">new</span> <span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-class);\">Map</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span>\n  <span class=\"token literal-property property\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-property);\">__listeners</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">:</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">new</span> <span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-class);\">Set</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span>\n  <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">set</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>key<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">this</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>__internalStore<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">set</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>key<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">this</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>__listeners<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">forEach</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">listener</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">listener</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">delete</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>key<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">this</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>__internalStore<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">delete</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>key<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">this</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>__listeners<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">forEach</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">listener</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">listener</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span>\n  <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">subscribe</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">listener</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">this</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>__listeners<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">add</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>listener<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">this</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>__listeners<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">delete</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>listener<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span>\n  <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">getSnapshot</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">this</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>__internalStore<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n\n<span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> <span class=\"token function-variable function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useFetch</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; margin-bottom: 0px; color: var(--prism-punctuation);\">,</span> requestInit</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n  <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">const</span> currentCache <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useSyncExternalStore</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>\n    cache<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>subscribe<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span>\n    <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useCallback</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> cache<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">getSnapshot</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">get</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n\n  <span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">// 缓存刷新逻辑</span>\n  <span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">// useEffect(() =&gt; ...</span>\n\n  <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">useEffect</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">let</span> isCancelled <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">let</span> abortController <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">null</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>isAbortControllerSupported<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      abortController <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">new</span> <span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-class);\">AbortController</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n\n    <span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">// 不再直接 `cache.get`，而是读取通过 useSyncExternalStore 获取到的 currentCache</span>\n    <span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">// TODO：理想中应该直接将 currentCache 视为 data，而不是将 currentCache 同步到 data 中</span>\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>currentCache<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setData</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>localCache<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span> <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">else</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">fetch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span> <span class=\"token literal-property property\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-property);\">signal</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">:</span> abortController<span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">?.</span>signal<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">...</span>requestInit <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n        <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">res</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> res<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">json</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n        <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">then</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">data</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n          <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">if</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">!</span>isCancelled<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n            <span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">// 写入 cache 时，直接使用 cache.set</span>\n            cache<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">set</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n            <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setData</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span>data<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n            <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n          <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n        <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span>\n        <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">catch</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">err</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n          <span class=\"token comment\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: var(--prism-comment-style); font-weight: inherit; color: var(--prism-comment);\">// if (!isCancelled) ...</span>\n        <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n\n    <span class=\"token keyword\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-keyword);\">return</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      isCancelled <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=</span> <span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">true</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      abortController<span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">?.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">abort</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n      <span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">setIsLoading</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token boolean\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-boolean);\">false</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span>\n  <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">[</span>url<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">,</span> requestInit<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">]</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">;</span>\n<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></code></pre><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">现在，每当有一个<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px;\">useFetch</code><span>&nbsp;</span>写入<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">cache</code><span>&nbsp;</span>后，React 都会使用<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">cache</code><span>&nbsp;</span>中的最新值更新所有使用了<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-bottom: 0px;\">useFetch</code><span>&nbsp;</span>的组件。</p><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">感觉到头昏脑涨了吗？绑紧你的安全带，让我们继续。</p><h2 id=\"Qing-Qiu-He-Bing-Qu-Zhong\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px 0.75rem; padding: 0px; scroll-margin-top: 0.75rem; font-weight: 600; color: var(--title); font-size: 24px; line-height: 32px; letter-spacing: 0.02em;\">请求合并去重</h2><blockquote class=\"iOARSJ ycSPk gVjJHb jSrOVh bCTcdn bYMDIj hcoyLE hvUkwC\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; padding: 0.75rem 1rem; background-color: var(--c-bg); border-left-width: 0.25em; border-left-color: var(--border); border-left-style: solid;\"><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0px; font-family: &quot;Source Sans Pro&quot;;\">There are two hard things in computer science: cache invalidation, naming things, and off-by-one errors.<br style=\"transition: background-color 0.1s ease-in-out 0s; margin-top: 0px;\">Oh and weird concurrency bugs.<br style=\"transition: background-color 0.1s ease-in-out 0s; margin-bottom: 0px;\">Oh and weird concurrency bugs.</p></blockquote><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">你的 React 应用可能是这样的：</p><pre class=\"language-jsx hljs\" data-lang=\"JSX\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; color: var(--code); padding: 0px; background: var(--pre); overflow: auto; white-space: pre; overflow-wrap: normal; border-radius: 4px; hyphens: none; contain: content; position: relative;\"><code class=\"language-jsx\" style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; word-break: normal; white-space: pre; display: block; overflow-x: auto; color: currentcolor; margin: 0px; padding: 0.75rem 1rem; background-color: transparent;\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Layout</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n  </span><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Carousel</span></span> <span class=\"token attr-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-property);\">list</span><span class=\"token script language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token script-punctuation punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">=</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>hotProductLists<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n    </span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>\n      <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">productId</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Product</span></span> <span class=\"token attr-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-property);\">id</span><span class=\"token script language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token script-punctuation punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">=</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>productId<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">/&gt;</span></span>\n    <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n  </span><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;/</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Carousel</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n  </span><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">ProductList</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n    </span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>allProductLists<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span><span class=\"token function\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-function);\">map</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">(</span><span class=\"token parameter\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">product</span> <span class=\"token operator\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-operator);\">=&gt;</span> <span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Product</span></span> <span class=\"token attr-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-property);\">key</span><span class=\"token script language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token script-punctuation punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">=</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>product<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>id<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span> <span class=\"token attr-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-property);\">id</span><span class=\"token script language-javascript\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\"><span class=\"token script-punctuation punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">=</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">{</span>product<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">.</span>id<span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">}</span></span> <span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">/&gt;</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">)</span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-punctuation);\">}</span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n  </span><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;/</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">ProductList</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span><span class=\"token plain-text\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit;\">\n</span><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-builtin);\"><span class=\"token tag\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-builtin);\"><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-top: 0px; color: var(--prism-punctuation);\">&lt;/</span><span class=\"token class-name\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-class);\">Layout</span></span><span class=\"token punctuation\" style=\"transition: background-color 0.1s ease-in-out 0s; font-style: inherit; font-weight: inherit; margin-bottom: 0px; color: var(--prism-punctuation);\">&gt;</span></span></code></pre><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">由于你在<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px;\">&lt;Product /&gt;</code><span>&nbsp;</span>组件中 Fetch on render，因此同一时刻，你的 React Tree 中可能存在不止一个<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">&lt;Product id={114514} /&gt;</code>；因此在页面首次加载、没有缓存时，你可能仍然会同时向同一个 URL 发送不止一次的请求。为了合并相同请求，你需要实现一个 mutex lock，避免多个<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code);\">useFetch</code><span>&nbsp;</span>向同一个 URL 发送多个请求；然后你还需要实现一个 pub/sub，将 API 的响应数据广播到所有使用这个 URL 的<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-bottom: 0px;\">useFetch</code>。</p><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">你觉得结束了吗？没有。</p><h2 id=\"Geng-Duo-Wo-Huan-Yao-Geng-Duo\" style=\"transition: background-color 0.1s ease-in-out 0s; margin: 1.5rem 0px 0.75rem; padding: 0px; scroll-margin-top: 0.75rem; font-weight: 600; color: var(--title); font-size: 24px; line-height: 32px; letter-spacing: 0.02em;\">更多，我还要更多</h2><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 1.5rem; font-family: &quot;Source Sans Pro&quot;;\">作为一个用于发送网络请求的、low-level 的 React Hook，<code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px; margin-bottom: 0px;\">useFetch</code><span>&nbsp;</span>需要实现的功能只多不少：</p><ul style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0px; padding: 0px 0px 0px 1.5rem; list-style: outside disc;\"><li style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0px 0px 0.375rem; padding: 0px; list-style-type: unset;\">Error Retry：在数据加载出问题的时候，要进行有条件的重试（如仅 5xx 时重试，403、404 时放弃重试）</li><li style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.375rem 0px; padding: 0px; list-style-type: unset;\">Preload：预加载数据，避免瀑布流请求</li><li style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.375rem 0px; padding: 0px; list-style-type: unset;\">SSR、SSG：服务端获取的数据用来提前填充缓存、渲染页面、然后再在客户端刷新缓存</li><li style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.375rem 0px; padding: 0px; list-style-type: unset;\">Pagination：大量数据、分页请求</li><li style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.375rem 0px; padding: 0px; list-style-type: unset;\">Mutation：响应用户输入、将数据发送给服务端</li><li style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.375rem 0px; padding: 0px; list-style-type: unset;\">Optimistic Mutation：用户提交输入时先更新本地 UI、形成「已经修改成功」的假象，同时异步将输入发送给服务端；如果出错，还需要回滚本地 UI</li><li style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.375rem 0px 0px; padding: 0px; list-style-type: unset;\">Middleware：日志、错误上报、Authentication</li></ul><p style=\"transition: background-color 0.1s ease-in-out 0s; margin: 0.75rem 0px 0px; font-family: &quot;Source Sans Pro&quot;;\">既然一个<span>&nbsp;</span><code style=\"transition: background-color 0.1s ease-in-out 0s; font-family: Consolas, Monaco, SFMono-Regular, &quot;Andale Mono&quot;, &quot;Liberation Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 0.875em; overflow-wrap: break-word; background-color: var(--alt); padding: 0.125em 0.35em 0.1em; vertical-align: 0.15em; border-radius: 0.25em; color: var(--code); margin-top: 0px;\">useFetch</code><span>&nbsp;</span>的需求这么多，为什么不直接使用现成的 React Data Fetching Hook 呢？不论<span>&nbsp;</span><a href=\"https://swr.vercel.app/\" rel=\"noopener noreferrer external nofollow\" target=\"_blank\" style=\"transition: background-color 0.1s ease-in-out 0s; color: var(--link); text-decoration: none; cursor: pointer;\">SWR</a><span>&nbsp;</span>还是<span>&nbsp;</span><a href=\"https://tanstack.com/query/v4\" rel=\"noopener noreferrer external nofollow\" target=\"_blank\" style=\"transition: background-color 0.1s ease-in-out 0s; color: var(--link); text-decoration: none; cursor: pointer; margin-bottom: 0px;\">React Query</a><span>&nbsp;</span>都能够覆盖这些功能。</p></section>"}}),
 :pages
 ({:block/uuid #uuid "62f399b1-39f3-4d46-874b-299a4cc79e74",
   :block/properties
   {:id "62f399b1-39f3-4d46-874b-299a4cc79e74",
    :name "page",
    :bindings {},
    :nonce 1,
    :assets []},
   :block/journal? false,
   :block/updated-at 1661147790103,
   :block/created-at 1660133420500,
   :block/whiteboard? true,
   :block/name "lol", 
   :block/original-name "lol"})}
